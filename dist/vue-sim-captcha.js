!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("vue-sim-captcha",[],e):"object"==typeof exports?exports["vue-sim-captcha"]=e():t["vue-sim-captcha"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(i[r])return i[r].exports;var a=i[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=2)}([function(t,e){function i(t,e){var i=t[1]||"",a=t[3];if(!a)return i;if(e&&"function"==typeof btoa){var o=r(a);return[i].concat(a.sources.map(function(t){return"/*# sourceURL="+a.sourceRoot+t+" */"})).concat([o]).join("\n")}return[i].join("\n")}function r(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=i(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},a=0;a<this.length;a++){var o=this[a][0];"number"==typeof o&&(r[o]=!0)}for(a=0;a<t.length;a++){var s=t[a];"number"==typeof s[0]&&r[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},function(t,e,i){"use strict";var r=i(11);e.a={name:"VueSimCaptcha",props:{value:{type:Boolean,required:!0,default:!1},appId:{type:String,required:!0},source:{type:Object,required:!0,validator:function(t){return void 0!==t.baseUrl}},callback:{type:Function,required:!0}},data:function(){return{vCodePos:[],resAppId:"",resTicket:"",resUserId:"",resVCodeImg:"",resVCodeTip:"",errorTip:"",markItems:[],valueData:this.value,layerClass:this.valueData?"simCaptcha-show":"simCaptcha-hidden",errorTipClass:"",sourceData:{baseUrl:this.source.baseUrl,imgUrl:this.source.imgUrl||"/api/SimCaptcha/Img",checkUrl:this.source.checkUrl||"/api/SimCaptcha/Check"}}},computed:{},watch:{value:function(t){this.valueData=t},valueData:function(t){this.$emit("input",t),t?(this.layerClass="simCaptcha-show",""==this.resVCodeImg&&this.refreshVCode()):this.layerClass="simCaptcha-hidden"},errorTip:function(){this.updateErrorTipClass()}},created:function(){0!=this.sourceData.imgUrl.indexOf("http")&&(0!=this.sourceData.imgUrl.indexOf("/")?this.sourceData.imgUrl=this.sourceData.baseUrl+"/"+this.sourceData.imgUrl:this.sourceData.imgUrl=this.sourceData.baseUrl+this.sourceData.imgUrl),0!=this.sourceData.checkUrl.indexOf("http")&&(0!=this.sourceData.checkUrl.indexOf("/")?this.sourceData.checkUrl=this.sourceData.baseUrl+"/"+this.sourceData.checkUrl:this.sourceData.checkUrl=this.sourceData.baseUrl+this.sourceData.checkUrl)},methods:{refreshVCode:function(){var t=this;this.vCodePos=[],this.clearPointMark(),r.a.httpGet(this.sourceData.imgUrl,function(e){0==e.code?(t.resVCodeImg=e.data.vCodeImg,t.resVCodeTip=e.data.vCodeTip,t.resUserId=e.data.userId):t.errorTip=e.message})},clearPointMark:function(){this.markItems=[]},markClick:function(t){for(var e=this.markItems.length,i=t;i<e;i++){this.markItems.pop(),this.vCodePos.pop()}},getImgClickPos:function(t){return{x:t.offsetX,y:t.offsetY}},imgClick:function(t){var e=this.getImgClickPos(t);this.createPointMark(e);var i=this.pxToPercentPos(e);this.vCodePos.push(i)},createPointMark:function(t){t.x=parseInt(t.x),t.y=parseInt(t.y),this.markItems.push({x:t.x-10,y:t.y-10})},pxToPercentPos:function(t){var e=this.getImgSize(),i=e.width,r=e.height;return{x:parseInt(t.x/i*100),y:parseInt(t.y/r*100)}},getImgSize:function(){return{width:this.$refs.simCaptchaImg.offsetWidth,height:this.$refs.simCaptchaImg.offsetHeight}},destroy:function(){this.valueData=!1,this.clearPointMark(),this.vCodePos=[],this.resVCodeImg="",this.resVCodeTip="",this.errorTip=""},showSuccessTip:function(t){this.errorTip="验证通过",setTimeout(this.destroy,500)},sendVCodePos:function(){var t=this,e=Date.now(),i={appId:this.appId,vCodePos:this.vCodePos,userId:this.resUserId,ua:navigator.userAgent,ts:e};r.a.httpPost(this.sourceData.checkUrl,i,function(e){if(0==e.code){var i={code:0,userId:t.resUserId,ticket:e.data.ticket,appId:e.data.appId,bizState:null};t.resAppId=i.appId,t.resTicket=i.ticket,t.callback(i),t.showSuccessTip()}else-1==e.code?(t.errorTip="点错啦, 请重试",t.vCodePos=[],t.clearPointMark()):-2==e.code?(t.errorTip="这题有点难, 为你换一个试试吧",t.refreshVCode()):-3==e.code?(t.errorTip="验证码无效, 为你换一个试试吧",t.refreshVCode()):-4==e.code?(t.errorTip="验证码过期, 为你换一个试试吧",t.refreshVCode()):-5==e.code&&(t.errorTip="验证码过期, 为你换一个试试吧",t.refreshVCode())})},updateErrorTipClass:function(){var t=this;"验证通过"==this.errorTip||""==this.errorTip?this.errorTipClass="simCaptcha-errorTip-success simCaptcha-errorTip-up":(this.errorTipClass="simCaptcha-errorTip-fail simCaptcha-errorTip-up",this.layerClass="simCaptcha-shake"),setTimeout(function(){"验证通过"==t.errorTip||""==t.errorTip?t.errorTipClass="simCaptcha-errorTip-success":(t.errorTipClass="simCaptcha-errorTip-fail",t.layerClass="simCaptcha-show")},1800)}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(3),a={install:function(t){t.component(r.a.name,r.a)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(a);console.log("\n %c vue-sim-captcha v0.1.0  %c https://github.com/yiyungent/vue-sim-captcha \n\n","color: #fff; background: #030307; padding:5px 0;","background: #ff80ab; padding:5px 0;"),e.default=a},function(t,e,i){"use strict";function r(t){i(4)}var a=i(1),o=i(12),s=i(10),n=r,c=s(a.a,o.a,!1,n,"data-v-40fb4c60",null);e.a=c.exports},function(t,e,i){var r=i(5);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);i(8)("5ae6f603",r,!0,{})},function(t,e,i){e=t.exports=i(0)(!1),e.i(i(6),""),e.push([t.i,"",""])},function(t,e,i){e=t.exports=i(0)(!1),e.i(i(7),""),e.push([t.i,".simCaptcha-hidden{display:none}.simCaptcha-show{display:block}@keyframes simCaptcha_shake{25%{margin-left:-6px}75%{margin-left:6px}to{margin-left:0}}@-webkit-keyframes simCaptcha_shake{25%{margin-left:-6px}75%{margin-left:6px}to{margin-left:0}}.simCaptcha-shake{-moz-animation:simCaptcha_shake .2s linear infinite both;-webkit-animation:simCaptcha_shake .2s linear infinite both;animation:simCaptcha_shake .2s linear infinite both}#simCaptcha-mask{width:100%;height:100%;position:fixed;left:0;top:0;background:#000;opacity:.5;z-index:2000000000}#simCaptcha-layer{position:fixed;top:50%;left:50%;padding:0 4px;transform:translate(-50%,-50%);background-size:20%;background-position:50% 32%;background-color:#fff;visibility:visible;z-index:2000000002;overflow:hidden;box-shadow:0 1px 8px hsla(0,0%,50%,.3);border:1px solid #d1d1d1;border-radius:2px}#simCaptcha-vCodeTip{text-align:center;height:40px;line-height:40px;font-size:14px;-moz-user-select:-moz-none;-ms-user-select:none;-webkit-user-select:none;user-select:none}#simCaptcha-img-box{position:relative;overflow:hidden;height:260px;width:260px}#simCaptcha-img{margin:0 auto;user-select:none;-webkit-touch-callout:none;-webkit-user-drag:none}@media screen and (min-width:900px){#simCaptcha-img{width:260px;height:260px}}@media screen and (max-width:900px){#simCaptcha-img{width:260px;height:260px}}#simCaptcha-loading{position:absolute;left:0;top:0;width:100%;height:100%;background:#e5e5e5;z-index:-1}#simCaptcha-loading .simCaptcha-loading-icon{font-family:sim-captcha-iconfont;font-size:30px;color:#b2b2b2;text-align:center;margin-top:102px}#simCaptcha-loading .simCaptcha-loading-tip{font-size:14px;color:#b2b2b2;text-align:center}.simCaptcha-mark{z-index:9999;width:25px;height:25px;background-color:#539ffe;text-align:center;line-height:25px;border-radius:50%;border:2px solid #fff;box-sizing:border-box;box-shadow:0 0 10px #000}#simCaptcha-errorTip,.simCaptcha-mark{position:absolute;color:#fff;user-select:none}#simCaptcha-errorTip{bottom:-30px;left:0;width:100%;text-align:left;text-indent:9px;font-size:16px;background-color:transparent;-moz-transition:bottom .4s ease-out;-o-transition:bottom .4s ease-out;-webkit-transition:bottom .4s ease-out;transition:bottom .4s ease-out;z-index:999;line-height:30px;-moz-user-select:-moz-none;-ms-user-select:none;-webkit-user-select:none}#simCaptcha-errorTip.simCaptcha-errorTip-fail{background-color:#de715b}#simCaptcha-errorTip.simCaptcha-errorTip-success{background-color:#5ebf70}#simCaptcha-errorTip.simCaptcha-errorTip-up{bottom:0}.simCaptcha-bottom{padding:4px 0;text-align:left}#simCaptcha-btn-close{font-size:26px}#simCaptcha-btn-close,#simCaptcha-btn-refresh{height:32px;line-height:32px;border:none;background-color:transparent;outline:none;color:gray;font-family:sim-captcha-iconfont}#simCaptcha-btn-refresh{font-size:22px;transform:translateY(-2px)}#simCaptcha-btn-confirm{float:right;width:94px;height:32px;border:none;background-color:#539ffe;outline:none;color:#fff}",""])},function(t,e,i){e=t.exports=i(0)(!1),e.push([t.i,'@font-face{font-family:sim-captcha-iconfont;src:url("/iconfont.eot?t=1596557635731");src:url("/iconfont.eot?t=1596557635731#iefix") format("embedded-opentype"),url("data:application/x-font-woff2;charset=utf-8;base64,d09GMgABAAAAAAP0AAsAAAAACGQAAAOnAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHEIGVgCDHAqEJINcATYCJAMQCwoABCAFhG0HQRtHBxHVmw3JvjjI5F7sBJJK5XSteDaVP1Z6nfZH434Pnq81fX/332VD6FJimakD4PEEtkaXjakxNQ4IhLuf13v/pEJupbwK4jBKk/ABBIAfv82Jl3QhYZE669jyB96BH19m1Rb8P8dMl9Q4zG+zOWU27Q1wFK0DWl+2FdmdMN4wduVFPA8BIpQhA9ZrZuMCDsU4JYBsRYYHgkvp0JpiwSH4JdcqyC5Q4kwl2S7Ajv/38oWS0AAGz4LxoskV0xDofIWnVPKC/wU+thmax7MA7CawQAuAgqyV2hawYawFciLKdqUVwOEwMNYK3dP2/wAJ9iJz5r88EAwWxAejMAZACcUtvILNgsArHQsGXlPl3CRajzsgDBwD8IFUuXG+XTEpBkYSjmNCIsxMa8ckyv4TdebVI4Ki5zBt5ZCv90h1/YS/79iHGXNrq2ILcTJdkt3c2wunAk7qMyYK2F1dWgomqzndXVurpws5MO/zGpfTItezWveLYjcs5bzYF9dCSpHLaU0Zll01AXB6Rz52mrVMjk5zXly8Ls5yupGZWVH66mkMK5zyaJtgq0k7PS/o26fVKg66lgmAo0nJcvbwasvJNw4YFLjSGNC4Fvg1L+o+vEPo3b+7fQeH+7m5MLYwHI+Loxl1dVAt7mFcMcXnSky6e3i4TxGmfF05HOGy0WOSMCG6YKG1sijMIhdVhrWFaeA4lZShCckZiZriRIhIRCR9fRJA2/Rv3AS5ujdI5o+IDEscfWOcYBRbUCIYmrdPG/kbef5nmRb5KSgpKawiE2Sv4FmHTqSKrSE3yiTlm9UbY7SKIy1yGwY7uhmp3IACAASt2WgEBMh/2+Y/fojKkR1Pf6Tz1dFf8tCV/ZSx7wlQQDs5/DZ+a/7/5bfsUVVo6FVlkc3T7Ep/IgMDREwj/NUUZLgaQ5FvHQHBpfgMDCGKYHHUIBXbAh5RSuDj6IAIzZjfHCVLEhZRWoAmSgEIKebBkOAELCn2kIq9BI8Cb8EnJeQQYV5Y7xmlTuDucjVQDjWVf+oqmdkyuktQnKB5j8okhT61gLFdkEIvyCafmGHGuMB+msg5JjYy0QO8DOMotBjpUTmvdW6JfZ/LfsirZFpdVlcD5VBT+aeukpndwe6S+/0EzXtUpqarwl7A2G59Cr2gBfIpm1t1Xct2+2ki5xgfYyMTPaAFoxkTWsr39aic1/aILLGP+nFbmTe/YnrCU0BkZbxD10asqHjsu0k12FejWBwN2PLadrUCAA==") format("woff2"),url("/iconfont.woff?t=1596557635731") format("woff"),url("/iconfont.ttf?t=1596557635731") format("truetype"),url("/iconfont.svg?t=1596557635731#iconfont") format("svg")}.sim-captcha-iconfont{font-family:sim-captcha-iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.sim-captcha-iconfont-icon-image:before{content:"\\E600"}.sim-captcha-iconfont-icon-close:before{content:"\\E60A"}.sim-captcha-iconfont-icon-refresh:before{content:"\\E675"}',""])},function(t,e,i){function r(t){for(var e=0;e<t.length;e++){var i=t[e],r=d[i.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](i.parts[a]);for(;a<i.parts.length;a++)r.parts.push(o(i.parts[a]));r.parts.length>i.parts.length&&(r.parts.length=i.parts.length)}else{for(var s=[],a=0;a<i.parts.length;a++)s.push(o(i.parts[a]));d[i.id]={id:i.id,refs:1,parts:s}}}}function a(){var t=document.createElement("style");return t.type="text/css",u.appendChild(t),t}function o(t){var e,i,r=document.querySelector("style["+g+'~="'+t.id+'"]');if(r){if(l)return m;r.parentNode.removeChild(r)}if(v){var o=f++;r=h||(h=a()),e=s.bind(null,r,o,!1),i=s.bind(null,r,o,!0)}else r=a(),e=n.bind(null,r),i=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else i()}}function s(t,e,i,r){var a=i?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,a);else{var o=document.createTextNode(a),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}function n(t,e){var i=e.css,r=e.media,a=e.sourceMap;if(r&&t.setAttribute("media",r),C.ssrId&&t.setAttribute(g,e.id),a&&(i+="\n/*# sourceURL="+a.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var c="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!c)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var p=i(9),d={},u=c&&(document.head||document.getElementsByTagName("head")[0]),h=null,f=0,l=!1,m=function(){},C=null,g="data-vue-ssr-id",v="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,i,a){l=i,C=a||{};var o=p(t,e);return r(o),function(e){for(var i=[],a=0;a<o.length;a++){var s=o[a],n=d[s.id];n.refs--,i.push(n)}e?(o=p(t,e),r(o)):o=[];for(var a=0;a<i.length;a++){var n=i[a];if(0===n.refs){for(var c=0;c<n.parts.length;c++)n.parts[c]();delete d[n.id]}}}};var b=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t,e){for(var i=[],r={},a=0;a<e.length;a++){var o=e[a],s=o[0],n=o[1],c=o[2],p=o[3],d={id:t+":"+a,css:n,media:c,sourceMap:p};r[s]?r[s].parts.push(d):i.push(r[s]={id:s,parts:[d]})}return i}},function(t,e){t.exports=function(t,e,i,r,a,o){var s,n=t=t||{},c=typeof t.default;"object"!==c&&"function"!==c||(s=t,n=t.default);var p="function"==typeof n?n.options:n;e&&(p.render=e.render,p.staticRenderFns=e.staticRenderFns,p._compiled=!0),i&&(p.functional=!0),a&&(p._scopeId=a);var d;if(o?(d=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},p._ssrRegister=d):r&&(d=r),d){var u=p.functional,h=u?p.render:p.beforeCreate;u?(p._injectStyles=d,p.render=function(t,e){return d.call(e),h(t,e)}):p.beforeCreate=h?[].concat(h,d):[d]}return{esModule:s,exports:n,options:p}}},function(t,e,i){"use strict";e.a={httpGet:function(t,e){var i=new XMLHttpRequest;i.open("GET",t,!0),i.onreadystatechange=function(){(4==i.readyState&&200==i.status||304==i.status)&&e.call(this,JSON.parse(i.responseText))},i.send()},httpPost:function(t,e,i){var r=new XMLHttpRequest;r.open("POST",t,!0),r.setRequestHeader("Content-Type","application/json"),r.onreadystatechange=function(){4!=r.readyState||200!=r.status&&304!=r.status||i.call(this,JSON.parse(r.responseText))},r.send(JSON.stringify(e))}}},function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.layerClass,attrs:{id:"simCaptcha-layer"}},[i("div",{attrs:{id:"simCaptcha-vCodeTip"}},[t._v(t._s(t.resVCodeTip))]),t._v(" "),i("div",{attrs:{id:"simCaptcha-img-box"}},[i("img",{directives:[{name:"show",rawName:"v-show",value:""!=t.resVCodeImg,expression:"resVCodeImg!=''"}],ref:"simCaptchaImg",attrs:{id:"simCaptcha-img",src:t.resVCodeImg},on:{click:t.imgClick}}),t._v(" "),t._m(0),t._v(" "),i("div",{attrs:{id:"simCaptcha-marks"}},t._l(t.markItems,function(e,r){return i("div",{key:r,staticClass:"simCaptcha-mark",style:{left:e.x+"px",top:e.y+"px"},attrs:{id:"simCaptcha-mark-"+(r+1)},on:{click:function(e){return t.markClick(r)}}},[t._v(t._s(r+1))])}),0),t._v(" "),i("span",{class:t.errorTipClass,attrs:{id:"simCaptcha-errorTip"}},[t._v(t._s(t.errorTip))])]),t._v(" "),i("div",{staticClass:"simCaptcha-bottom"},[i("button",{attrs:{id:"simCaptcha-btn-close"},on:{click:function(e){t.valueData=!1}}},[t._v("")]),t._v(" "),i("button",{attrs:{id:"simCaptcha-btn-refresh"},on:{click:t.refreshVCode}},[t._v("")]),t._v(" "),i("button",{attrs:{id:"simCaptcha-btn-confirm"},on:{click:t.sendVCodePos}},[t._v("确认")])])])},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"simCaptcha-loading"}},[i("div",{staticClass:"simCaptcha-loading-icon"},[t._v("")]),t._v(" "),i("div",{staticClass:"simCaptcha-loading-tip"},[t._v("加载中...")])])}],o={render:r,staticRenderFns:a};e.a=o}])});
//# sourceMappingURL=vue-sim-captcha.js.map